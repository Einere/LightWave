KWU LightWave Meeting Log
=========================

About Team
-------------------------

- Team : Moomin Valley
- Leader : Hyung-jun Choi
- Member : Jeong-woo Kim, Jun-hyung Kim

# 18/12/21

## 역할 분담
socket transmission implement

- android client : CHJ, KJH
- windows MFC server : KJW

## 깃 설정
깃허브 리포지토리 생성
포크 및 클론

## 다음주 계획
각자 소켓 통신 구현하기

# 18/12/28

## 코드 리뷰
- 테스트용 클라이언트를 통해 에코 서버 리뷰 (KJW)
- 모바일 간 소켓 통신 리뷰 (CHJ)

## 다음주 계획
- 패킷 정의하기
- PC서버와 Mobile클라이언트 간 통신 구현하기

# 19/01/03

## Android 실행 흐름 정의 (CHJ, KJH)
1. 앱 실행
2. 서버 연결 액티비티 실행, 연결
3. 연결 성공시 세션 서비스 실행
4. 홈 화면 액티비티 실행
5. 작업 정보 취득 액티비티 실행, 서버로 request 요청, response 받아서 화면에 작업 정보 랜더링
6. 작업 시작 버튼 클릭시, 작업 정보 작성 액티비티 실행, 사용자가 작업 정보를 작성한 뒤 전송 버튼 클릭
7. 사용자의 작업 정보를 패킷에 담아서 서버로 전송
8. ...

## 서버 연결 정보 유지 (CHJ, KJH)
singleton패턴을 적용한 manager service 사용

## 코딩 스타일 가이드 정의 (CHJ, KJH)
명확하고 자세한 변수명과 메소드명.
카멜 케이스 사용.

## 서버와 클라이언트 간의 송수신 확인 (KJW, KJH)

## 다음주 계획
- 패킷 정의
- server UI update
- client 개발 시작

# 19/01/10

## 중복 binding으로 인한 에러 (KJH, CHJ)
하나의 service에 여러 Activity가 binding될 수 없다.
따라서 다음과 같은 솔루션이 있다.

- [Application 사용][application]
- [Activity 전환시 unbind][unbind]
- 한 Activity에 service를 binding한 뒤, broadcast로 액티비티간 service 요청 및 응답.

[application]: URL "https://stackoverflow.com/questions/30648766/binding-a-service-to-multiple-activities"
[unbind]: URL "http://sterl.org/2016/06/android-bind-service-to-the-application-cross-activities/"

# 19/01/22

## GPS정보 취득, 지도 API 활용 (KJH)
GPS정보 취득 구현. 지도 API활용 방법 구현중.  
현재 지도 API는 일정 건수 이상 요청이 발생하는 경우, 요금을 청구하는 방식을 사용 중.  
회사와 협의를 해야 하는 상태.

## 앨범(갤러리)에서 사진 선택 후 전송 기능 (CHJ)
버튼을 클릭하여 앨범에서 사진 하나를 선택, serialize하여 json문자열에 포함시켜 전송하는 기능 구현.

## 각종 서버 기능 구현 (KJW)
여러가지 서버 기능 구현.

## 업체에 궁금한 사항들을 문의 (KJW, KJH, CHJ)
1. 작업정보에 대해 자세한 설명이 필요합니다. (필요한 데이터에 무엇이 있는지)
2. 소켓 통신 테스트용 광파기 데이터 파일이 필요합니다.
3. 서버에서 UI를 크게 할 필요가 있는지 궁금합니다. 현재 논의된 사항으로는 서버는 작업자들의 작업정보만 간단하게 조회하는 기능만이 필요한 것으로 예상됩니다.
4. 보안상 c++이 더 유리한 이유가 궁금합니다. 그렇다고 한다면 보안상 구현해야 될 부분을 가르쳐주세요.
6. 어느 지도api를, 어떻게 사용하는 것이 좋을까요? 결제는 어떻게 할것인지? (현재 대부분의 지도 api는 유료라고 합니다.)
7. 서버 로직을 웹서버처럼 요청&응답 구조로 구현해야 하나요? 아니면 서버에서 능동적으로 클라이언트에게 데이터를 전송할 필요가 있나요?
8. 서버에서 데이터 관리를 어떻게 하나요? DB를 사용해야 하나요? 아니면 단순히 파일로 저장하나요?
9. api 최소 버전 어디까지 지원? 기기 종류가 아닌, api넘버로 답변을 부탁드립니다..
10. 라이브러리에 대한 제한은 없는지? (ex. c++ 부스트 라이브러리)

## 다음주 계획

회사의 피드백에 따라 진행 방향 결정.

# 19/01/27

## 카메라, 갤러리, 방위 기능 구현 (CHJ)
버튼 클릭시 카메라 앱을 연 뒤, 촬영한 사진을 가져오는 기능 구현.
버튼 클릭시 갤러리에서 사진을 선택하여 가져오는 기능 구현.
모바일의 현재 방위(azimuth)값을 가져오는 기능 구현.

## 리팩토링, 접속자 수 실시간 집계 (KJW)

## 중간보고서 작성 (KJW, KJH, CHJ)
중간보고서 작성

## 다음주 계획
요구사항 2-4 ~ 2-6 수행 (KJH, CHJ)
2차 미팅 질문 정리 (KJW, KJH, CHJ)
스크롤 뷰 구현 (CHJ)
테스트용 공기계에서 카메라를 통해 사진 촬영 후 가져오기 실패 이유 분석 (KJH, CHJ)
사진 촬영 시 방위 값 가져올 방법 검색 (KJH, CHJ)

# 19/02/12

## 앱 내에서 자체 카메라 기능 구현 중 (KJH)

## 사진, 메모 등의 데이터를 파일시스템에 저장 & 불러오기 기능 구현 (KJH)

## 작업 등록 기능 구현 (KJW)
cif파일명만 받음.

## 서버 로그 기능 구현 (KJW)

## 소켓 현황 확인 기능 구현 (KJW)

## 다음주 계획
- 사진 촬영시 브로드캐스트를 이용하여 방위 등의 정보 저장하기 (20이하 버전) (CHJ)
- 사진 촬영시 이벤트 핸들러를 이용하여 방위 등의 정보 저장하기 (21이상 버전) (KJH)
- 2/26 회사와 미팅 약속잡기
- 동방에 제본 뜰 책 갖다놓기 (KJW)
- 작업 시작 기능 구현 (KJW)

# 19/03/07
## 데이터 송수신 기능 확인 (ALL)
서비스에서 매니저의 인스턴스를 리퍼런싱하도록 하여, 매니저의 setter를 호출하여 데이터를 전송하도록 구현.(CHJ, KJH)

## 송수신 할 데이터를 정의 (ALL)
json객체에 필요한 필드
- method : 서버로 전송시 사용
- responseCode : 서버에서 응답시 사용
- ??? : 필지 객체의 배열
  - 필지 : 
    - 필지의 고유번호(옵션)
    - 점의 개수
    - 점의 x, y좌표 쌍 배열
    
## 회사에 질문하기. (ALL)
- cif의 점의 데이터는 실수형 x,y좌표로 되어 있는데, 해당 데이터를 지도 api에 그리기 위해서는 위도 경도로 변환이 필요함. 어떻게 해야 되는가..
- 혹시 7페이지의 액티비티 화면과 8페이지의 액티비티 화면을 합쳐도 되는지? 즉 7페이지의 액티비티에 "사진선택", "
- 사진별 메모인지, 점별 메모인가?
- 안드로이드 테스트 기기 지원은 가능한가?
## 클라이언트에서 요청순서와 응답순서가 다를 경우
클라이언트에서, 첫번째 요청 이후 중복된 요청은 플래그를 통해 차단하는 방식으로 구현.

# 19/03/11
## TM좌표계와 위경도 변환방법 찾기 (KJH, CHJ)
국토정보플랫폼에서 위경도 -> TM좌표 변환은 지원. 그러나 역변환은 지원하지 않음.  
https://autoc.tistory.com/315 에서 TM좌표 -> 위경도 변환 엑셀 파일은 다운로드 가능하나, 부정확한것으로 보임.

## 서비스와 매니저간의 옵저버 패턴 구현 (KJH, CHJ)
서비스에서 소켓통신을 통해 서버로부터 받은 데이터를 매니저에게 전달해주기 위해, 옵저버 패턴을 구현.  
기존에는 매니저만 서비스의 인스턴스를 가지고 있었으나, 수정 후 서비스도 매니저의 인스턴스를 가진다.  
서비스는 매니저의 게터, 세터를 호출하여 소켓통신을 통해 서버로부터 받은 데이터를 매니저의 receivedData에 할당.  
액티비티에서는 매니저의 게터를 통해 null값 여부를 판단하여 동기화 작업을 수행 가능.

## 6~7페이지의 구체적인 로직 정의 (KJH, CHJ)
1. 특정 점을 누르면, 해당 점의 정보를 가져온다.
2. 점의 이름을 가져와서, 해당 이름과 동일한 폴더 객체(File type)을 얻는다.
참고 : https://stackoverflow.com/questions/16557650/how-to-display-images-saved-in-sdcard-folder-in-android
3. 해당 폴더 객체에서 이미지, 텍스트 등의 파일들을 분류한다. 
4. 이미지는 RecyclerView에 넣어주고 ArrayList에 추가하며, 텍스트 파일은 ArrayList에 추가한다.
5. 해당 점에 사진을 추가하고자 한다면, 기존의 TedBottomPicker를 사용하여 사진들의 Uri를 얻어서 아까 얻어서 해당 폴더에 저장한다.
6. 저장된 사진들 중에서 몇개를 골라서 전송하는 방법보다는, 저장된 모든 사진들을 전송하는 방법이 더 편할 것 같으므로, 현재 사진과 텍스트 ArrayList의 정보들을 json으로 만들어 serialize하여 서버로 전송한다.

# 19/03/18
## 커스텀 이미지 피커 기본 기능 구현 (CHJ)
이미지 피커 라이브러리를 찾아보고 알아보았지만, 특정 폴더에 접근하여 다중선택이 되는 라이브러리가를 찾을 수 없어, 직접 구현했다.  
현재 구현한 기능  
- 특정 폴더에 존재하는 이미지 목록을 선택할 수 있는 액티비티를 띄우는 기능.
- 이미지 피커 액티비티에서, 업로드할 사진을 선택할 수 있는 기능. (gray scale로 표시)
- 이미지 피커 액티비티에서, 선택한 사진들의 Uri를 CaptureActivity로 반환하는 기능.
  
구현해야 할 기능
- 최대 선택 갯수 제한 및 토스트 메세지 띄우기 기능.
  



